<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Epigno Tech Blog</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="The [content module](https://content.nuxtjs.org/) is a git files based headless CMS that provides powerful features when it comes to write blogs, documentation sites or just adding content to any regular website. In this post we will go through most of the benefits of this module and discover how we can create a blog with it."><meta data-n-head="ssr" data-hid="i18n-og" property="og:locale" content="en"><meta data-n-head="ssr" data-hid="i18n-og-alt-ja" property="og:locale:alternate" content="ja"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" data-hid="i18n-alt-ja" rel="alternate" href="/blog/timezones-are-hell" hreflang="ja"><link data-n-head="ssr" data-hid="i18n-alt-en" rel="alternate" href="/en/blog/timezones-are-hell" hreflang="en"><link data-n-head="ssr" data-hid="i18n-xd" rel="alternate" href="/blog/timezones-are-hell" hreflang="x-default"><link data-n-head="ssr" data-hid="i18n-can" rel="canonical" href="/en/blog/timezones-are-hell"><link rel="preload" href="/_nuxt/c49df97.js" as="script"><link rel="preload" href="/_nuxt/ebf3282.js" as="script"><link rel="preload" href="/_nuxt/f660dd4.js" as="script"><link rel="preload" href="/_nuxt/1d9a650.js" as="script"><link rel="preload" href="/_nuxt/e275d6c.js" as="script"><style data-vue-ssr-id="38dfa7e4:0 0623093e:0 fa7ff0ca:0 56b15182:0 083745fe:0 cbe8e72c:0">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}.container{width:100%}@media (min-width:320px){.container{max-width:320px}}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1351px){.container{max-width:1351px}}.bg-black{--bg-opacity:1;background-color:#000;background-color:rgba(0,0,0,var(--bg-opacity))}.bg-blue-500{--bg-opacity:1;background-color:#4299e1;background-color:rgba(66,153,225,var(--bg-opacity))}.border-gray-500{--border-opacity:1;border-color:#a0aec0;border-color:rgba(160,174,192,var(--border-opacity))}.rounded-full{border-radius:9999px}.border{border-width:1px}.border-t-2{border-top-width:2px}.flex{display:flex}.table{display:table}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.self-center{align-self:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.font-medium{font-weight:500}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-48{height:12rem}.h-full{height:100%}.text-sm{font-size:.875rem}.text-2xl{font-size:1.5rem}.text-4xl{font-size:2.25rem}.text-6xl{font-size:4rem}.m-4{margin:1rem}.m-8{margin:2rem}.mr-2{margin-right:.5rem}.mb-2{margin-bottom:.5rem}.mr-3{margin-right:.75rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.mt-8{margin-top:2rem}.mr-8{margin-right:2rem}.mt-16{margin-top:4rem}.-mb-3{margin-bottom:-.75rem}.object-cover{-o-object-fit:cover;object-fit:cover}.overflow-y-scroll{overflow-y:scroll}.p-4{padding:1rem}.p-6{padding:1.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.static{position:static}.absolute{position:absolute}.relative{position:relative}.top-32{top:32px}.right-32{right:32px}.left-32{left:32px}.top-3rem{top:3rem}.right-3rem{right:3rem}.shadow-sm{box-shadow:0 1px 2px 0 rgba(0,0,0,.05)}.hover\:shadow-md:hover{box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}.text-center{text-align:center}.text-white{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.text-gray-600{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.uppercase{text-transform:uppercase}.hover\:underline:hover{text-decoration:underline}.tracking-wider{letter-spacing:.05em}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.w-full{width:100%}.w-screen{width:100vw}.transition-colors{transition-property:background-color,border-color,color,fill,stroke}.transition-shadow{transition-property:box-shadow}.ease-linear{transition-timing-function:linear}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-150{transition-duration:.15s}.duration-300{transition-duration:.3s}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}.nuxt-content-highlight{position:relative}.nuxt-content-highlight .filename{position:absolute;right:0;--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity));font-weight:300;z-index:10;margin-right:.5rem;margin-top:.25rem;font-size:.875rem}@media (min-width:320px){.xs\:container{width:100%}}@media (min-width:320px) and (min-width:320px){.xs\:container{max-width:320px}}@media (min-width:320px) and (min-width:640px){.xs\:container{max-width:640px}}@media (min-width:320px) and (min-width:768px){.xs\:container{max-width:768px}}@media (min-width:320px) and (min-width:1024px){.xs\:container{max-width:1024px}}@media (min-width:320px) and (min-width:1280px){.xs\:container{max-width:1280px}}@media (min-width:320px) and (min-width:1351px){.xs\:container{max-width:1351px}}@media (min-width:320px){.xs\:flex-col{flex-direction:column}.xs\:h-84{height:22rem}.xs\:mb-6{margin-bottom:1.5rem}.xs\:py-8{padding-top:2rem;padding-bottom:2rem}.xs\:px-8{padding-left:2rem;padding-right:2rem}.xs\:w-full{width:100%}}@media (min-width:640px){.sm\:container{width:100%}}@media (min-width:640px) and (min-width:320px){.sm\:container{max-width:320px}}@media (min-width:640px) and (min-width:640px){.sm\:container{max-width:640px}}@media (min-width:640px) and (min-width:768px){.sm\:container{max-width:768px}}@media (min-width:640px) and (min-width:1024px){.sm\:container{max-width:1024px}}@media (min-width:640px) and (min-width:1280px){.sm\:container{max-width:1280px}}@media (min-width:640px) and (min-width:1351px){.sm\:container{max-width:1351px}}@media (min-width:768px){.md\:container{width:100%}}@media (min-width:768px) and (min-width:320px){.md\:container{max-width:320px}}@media (min-width:768px) and (min-width:640px){.md\:container{max-width:640px}}@media (min-width:768px) and (min-width:768px){.md\:container{max-width:768px}}@media (min-width:768px) and (min-width:1024px){.md\:container{max-width:1024px}}@media (min-width:768px) and (min-width:1280px){.md\:container{max-width:1280px}}@media (min-width:768px) and (min-width:1351px){.md\:container{max-width:1351px}}@media (min-width:768px){.md\:mb-12{margin-bottom:3rem}.md\:w-1\/2{width:50%}.md\:w-1\/3{width:33.333333%}}@media (min-width:1024px){.lg\:container{width:100%}}@media (min-width:1024px) and (min-width:320px){.lg\:container{max-width:320px}}@media (min-width:1024px) and (min-width:640px){.lg\:container{max-width:640px}}@media (min-width:1024px) and (min-width:768px){.lg\:container{max-width:768px}}@media (min-width:1024px) and (min-width:1024px){.lg\:container{max-width:1024px}}@media (min-width:1024px) and (min-width:1280px){.lg\:container{max-width:1280px}}@media (min-width:1024px) and (min-width:1351px){.lg\:container{max-width:1351px}}@media (min-width:1024px){.lg\:flex-row{flex-direction:row}.lg\:flex-1{flex:1 1 0%}.lg\:h-full{height:100%}.lg\:h-screen{height:100vh}.lg\:overflow-hidden{overflow:hidden}.lg\:px-16{padding-left:4rem;padding-right:4rem}.lg\:py-32{padding-top:8rem;padding-bottom:8rem}.lg\:w-1\/2{width:50%}}@media (min-width:1280px){.xl\:container{width:100%}}@media (min-width:1280px) and (min-width:320px){.xl\:container{max-width:320px}}@media (min-width:1280px) and (min-width:640px){.xl\:container{max-width:640px}}@media (min-width:1280px) and (min-width:768px){.xl\:container{max-width:768px}}@media (min-width:1280px) and (min-width:1024px){.xl\:container{max-width:1024px}}@media (min-width:1280px) and (min-width:1280px){.xl\:container{max-width:1280px}}@media (min-width:1280px) and (min-width:1351px){.xl\:container{max-width:1351px}}@media (min-width:1351px){.xxlmin\:container{width:100%}}@media (min-width:1351px) and (min-width:320px){.xxlmin\:container{max-width:320px}}@media (min-width:1351px) and (min-width:640px){.xxlmin\:container{max-width:640px}}@media (min-width:1351px) and (min-width:768px){.xxlmin\:container{max-width:768px}}@media (min-width:1351px) and (min-width:1024px){.xxlmin\:container{max-width:1024px}}@media (min-width:1351px) and (min-width:1280px){.xxlmin\:container{max-width:1280px}}@media (min-width:1351px) and (min-width:1351px){.xxlmin\:container{max-width:1351px}}@media (min-width:1351px){.xxlmin\:w-1\/2{width:50%}}@media (max-width:1350px){.xxlmax\:container{width:100%}}@media (max-width:1350px) and (min-width:320px){.xxlmax\:container{max-width:320px}}@media (max-width:1350px) and (min-width:640px){.xxlmax\:container{max-width:640px}}@media (max-width:1350px) and (min-width:768px){.xxlmax\:container{max-width:768px}}@media (max-width:1350px) and (min-width:1024px){.xxlmax\:container{max-width:1024px}}@media (max-width:1350px) and (min-width:1280px){.xxlmax\:container{max-width:1280px}}@media (max-width:1350px) and (min-width:1351px){.xxlmax\:container{max-width:1351px}}@media (max-width:1350px){.xxlmax\:flex-col{flex-direction:column}.xxlmax\:w-full{width:100%}}code[class*=language-],pre[class*=language-]{text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#c3cee3;background:#263238;font-family:Roboto Mono,monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#363636}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#363636}:not(pre)>code[class*=language-]{white-space:normal;border-radius:.2em;padding:.1em}pre[class*=language-]{overflow:auto;position:relative;margin:.5em 0;padding:1.25em 1em}.language-css>code,.language-sass>code,.language-scss>code{color:#fd9170}[class*=language-] .namespace{opacity:.7}.token.atrule{color:#c792ea}.token.attr-name{color:#ffcb6b}.token.attr-value,.token.attribute{color:#c3e88d}.token.boolean{color:#c792ea}.token.builtin{color:#ffcb6b}.token.cdata,.token.char{color:#80cbc4}.token.class{color:#ffcb6b}.token.class-name,.token.color{color:#f2ff00}.token.comment{color:#546e7a}.token.constant{color:#c792ea}.token.deleted{color:#f07178}.token.doctype{color:#546e7a}.token.entity{color:#f07178}.token.function{color:#c792ea}.token.hexcode{color:#f2ff00}.token.id,.token.important{color:#c792ea;font-weight:700}.token.inserted{color:#80cbc4}.token.keyword{color:#c792ea;font-style:italic}.token.number{color:#fd9170}.token.operator{color:#89ddff}.token.prolog{color:#546e7a}.token.property{color:#80cbc4}.token.pseudo-class,.token.pseudo-element{color:#c3e88d}.token.punctuation{color:#89ddff}.token.regex{color:#f2ff00}.token.selector{color:#f07178}.token.string{color:#c3e88d}.token.symbol{color:#c792ea}.token.tag,.token.unit{color:#f07178}.token.url{color:#fd9170}.token.variable{color:#f07178}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}html{font-family:"Source Sans Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;font-size:16px;word-spacing:1px;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;box-sizing:border-box}*,:after,:before{box-sizing:border-box;margin:0}.nuxt-content p{margin-bottom:20px}.nuxt-content h2{font-weight:700;font-size:28px}.nuxt-content h3{font-weight:700;font-size:22px}.icon.icon-link{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBjbGFzcz0iaGVyb2ljb24tdWkiIGQ9Ik0xMS4wMyA4aDMuOTRsMS4wNi00LjI0YTEgMSAwIDEgMSAxLjk0LjQ4TDE3LjAzIDhIMjBhMSAxIDAgMCAxIDAgMmgtMy40N2wtMSA0SDE4YTEgMSAwIDEgMSAwIDJoLTIuOTdsLTEuMDYgNC4yNWExIDEgMCAxIDEtMS45NC0uNDlsLjk0LTMuNzZIOS4wM2wtMS4wNiA0LjI1YTEgMSAwIDEgMS0xLjk0LS40OUw2Ljk3IDE2SDRhMSAxIDAgMCAxIDAtMmgzLjQ3bDEtNEg2YTEgMSAwIDAgMSAwLTJoMi45N2wxLjA2LTQuMjRhMSAxIDAgMSAxIDEuOTQuNDhMMTEuMDMgOHptLS41IDJsLTEgNGgzLjk0bDEtNGgtMy45NHoiLz48L3N2Zz4K);display:inline-block;width:20px;height:20px;background-size:20px 20px}.logo[data-v-d4354a60]{height:40px}</style><link rel="preload" href="/_nuxt/static/1606809417/en/blog/timezones-are-hell/payload.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><article class="flex lg:h-screen w-screen lg:overflow-hidden xs:flex-col lg:flex-row"><div class="relative lg:w-1/2 xs:w-full xs:h-84 lg:h-full post-left bg-black"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/World_Time_Zones_Map.png/1920px-World_Time_Zones_Map.png" alt="Random image" class="absolute h-full w-full object-cover"> <div class="overlay"></div> <div class="absolute top-32 left-32 text-white"><a href="/en" class="nuxt-link-active"><img src="/_nuxt/img/logo_green_e.b67e3e6.svg" class="logo" data-v-d4354a60></a> <div class="mt-16 -mb-3 flex uppercase text-sm"><p class="mr-3">
          July 4, 2018
        </p> <span class="mr-3">•</span> <p>Malik Olivier Boussejra</p></div> <h1 class="text-6xl font-bold">Timezones are hell</h1> <span><a href="/en/blog/tag/trivia"><span class="truncate uppercase tracking-wider font-medium text-ss px-2 py-1 rounded-full mr-2 mb-2 border border-light-border dark:border-dark-border transition-colors duration-300 ease-linear">
            trivia
          </span></a></span><span><a href="/en/blog/tag/python"><span class="truncate uppercase tracking-wider font-medium text-ss px-2 py-1 rounded-full mr-2 mb-2 border border-light-border dark:border-dark-border transition-colors duration-300 ease-linear">
            python
          </span></a></span><span><a href="/en/blog/tag/postgres"><span class="truncate uppercase tracking-wider font-medium text-ss px-2 py-1 rounded-full mr-2 mb-2 border border-light-border dark:border-dark-border transition-colors duration-300 ease-linear">
            postgres
          </span></a></span></div> <div class="flex absolute top-3rem right-3rem"><a href="https://epigno.jp" class="mr-8 self-center text-white font-bold hover:underline">
        Epigno
      </a> </div></div> <div class="relative xs:py-8 xs:px-8 lg:py-32 lg:px-16 lg:w-1/2 xs:w-full h-full overflow-y-scroll markdown-body post-right custom-scroll"><h1 class="font-bold text-4xl">Timezones are hell</h1> <div class="nuxt-content"><p>Timezones are hell.
This is really the kind of hell you don't want to get into, unless you really
need to.</p>
<p>After getting timezone issues, I started wishing that all countries switch
to UTC!</p>
<p>Alas, timezones, like many things, are here to stay.
Until the 19th century, each city had its own local time calculated from the
sun's movements. However, interconnections between communities forced
the people to agree on a common time, a.k.a a time zone.</p>
<p>Unfortunately, as with all human agreements, timezones do not correlate very
well with natural phenomena, here, Earth's geometry.
While both are continent-size countries, the US shares more than 5 timezones, while China
only has <em>one</em> single timezone.
Then some countries include energy-saving time changes. They even move 1 hour
in some countries during specific periods (e.g. Morocco during the month of Ramadan).
Or did you know that an island in the Pacific changed <em>date</em> after its leaders
decided to move to the other side of the international date-changing line?</p>
<p>Hopefully a lot of experienced developers thought really hard to solve these
issues, both for database management systems and programming languages.</p>
<h1 id="timezones-in-python"><a href="#timezones-in-python" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Timezones in Python</h1>
<p>Let's take a look at Python's most known solution to the timezone mess.</p>
<p>Let's fire up a Python REPL:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token operator">>></span><span class="token operator">></span>
<span class="token operator">>></span><span class="token operator">></span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">17268</span><span class="token punctuation">)</span>
</code></pre></div>
<p>So it's now July 4th 2018 7:48:07 AM (and some microseconds).
This is my local time.</p>
<p>Python has a handy function to get UTC time:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token operator">>></span><span class="token operator">></span> datetime<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span>
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">827155</span><span class="token punctuation">)</span>
</code></pre></div>
<p>So it's now July 3rd 2018 22:51:17 (and some microseconds) in UTC time.</p>
<p>But where is the timezone information? How do I know, given a python <code>datetime</code>,
what is the the timezone of the specific time?
Well, that may sound harsh, but you <strong>cannot</strong>.</p>
<p>By default, all datetimes in python are said to be "timezone-unaware"!</p>
<h2 id="timezone-awareness-in-python"><a href="#timezone-awareness-in-python" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Timezone-awareness in Python</h2>
<p>As it appears, Python has two datetime types. One is said "timezone-unaware",
while the other is said "timezone-aware".</p>
<p>Let's make a timezone-aware datetime. For that we will use the <code>pytz</code> module.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> pytz
<span class="token operator">>></span><span class="token operator">></span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># Create a timezone object</span>
<span class="token operator">>></span><span class="token operator">></span> tz <span class="token operator">=</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">'Asia/Tokyo'</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span>tz
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">637167</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span><span class="token operator">&lt;</span>DstTzInfo <span class="token string">'Asia/Tokyo'</span> JST<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span> STD<span class="token operator">></span><span class="token punctuation">)</span>
</code></pre></div>
<p>Cool! As you see, the <code>datetime.now</code> function can take a timezone object as
argument, if you do so, it will return a the current time in the given timezone
as a timezone-aware datetime.</p>
<p>As you can see, if the <code>tzinfo</code> attribute is set, then a datetime becomes
timezone-aware. You can easily check if a datetime is tz-aware as follows:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token keyword">def</span> <span class="token function">am_i_tzaware</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> dt<span class="token punctuation">.</span>tzinfo <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>
</code></pre></div>
<p>However, there is something you should never, never do (unless you know what
you are doing): manually changing the <code>tzinfo</code> attribute of a datetime, either
by setting the attribute or using the <code>replace</code> method. This <strong>WILL NOT</strong>
do what you think it will do. You will get behavior that 99.99% of people do
not want.</p>
<p>Let's try:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> pytz
<span class="token operator">>></span><span class="token operator">></span>
<span class="token operator">>></span><span class="token operator">></span> tokyo_tz <span class="token operator">=</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">'Asia/Tokyo'</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> paris_tz <span class="token operator">=</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">'Europe/Paris'</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tokyo_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span>tokyo_tz<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> paris_time <span class="token operator">=</span> tokyo_time<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>tzinfo<span class="token operator">=</span>paris_tz<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> paris_time
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">903127</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span><span class="token operator">&lt;</span>DstTzInfo <span class="token string">'Europe/Paris'</span> LMT<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">09</span><span class="token punctuation">:</span><span class="token number">00</span> STD<span class="token operator">></span><span class="token punctuation">)</span>
</code></pre></div>
<p>Please take a clear look at the information after the <code>tzinfo</code> keyword.
WTF??? What the heck is this 9 minutes offset???
Have you ever heard of a timezone named LMT+0:09:00???</p>
<h2 id="deeper-look-into-pytz"><a href="#deeper-look-into-pytz" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Deeper look into <a href="https://pythonhosted.org/pytz/" rel="nofollow noopener noreferrer" target="_blank">pytz</a></h2>
<p>I know what you are thinking:
"Please explain what is this 9 minutes offset! If my program keeps on like this,
calamity will happen."</p>
<p>Well, these are historical timezones (yes, <a href="https://en.wikipedia.org/wiki/Local_mean_time" rel="nofollow noopener noreferrer" target="_blank">they existed</a>!). And people dealing
with times from the first half of the 20th century may need them.</p>
<p><code>pytz</code> can actually deal with the timezones of almost any region after the 1900s.</p>
<p>And if you only use the timezone object as is, it may show a historical offset for
the area.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token operator">>></span><span class="token operator">></span> tokyo_tz
<span class="token operator">&lt;</span>DstTzInfo <span class="token string">'Asia/Tokyo'</span> LMT<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">00</span> STD<span class="token operator">></span>
<span class="token operator">>></span><span class="token operator">></span> paris_tz
<span class="token operator">&lt;</span>DstTzInfo <span class="token string">'Europe/Paris'</span> LMT<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">09</span><span class="token punctuation">:</span><span class="token number">00</span> STD<span class="token operator">></span>
</code></pre></div>
<p>When you use the <code>now</code> function, the timezone object will update itself
to use the correct offset that politics-driven people happened to choose at the current time
in the selected region. The timezone object will not be updated if you directly
use it with the <code>tzinfo</code> attribute.
But how do I convert the time to another timezone then?</p>
<p>Here is what you can do with a <code>tzaware_localize</code> function:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> pytz


<span class="token keyword">def</span> <span class="token function">tzaware_localize</span><span class="token punctuation">(</span>dt<span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">,</span> local_tz<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Takes a TZ-unaware datetime in local time *or* a TZ-aware datetime and turns
    it into a TZ-aware datetime in the provided timezone.
    :return: TZ-aware DateTime in the provided timezone
    """</span>
    <span class="token keyword">if</span> dt<span class="token punctuation">.</span>tzinfo <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span>local_tz<span class="token punctuation">)</span><span class="token punctuation">.</span>localize<span class="token punctuation">(</span>dt<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> dt<span class="token punctuation">.</span>astimezone<span class="token punctuation">(</span>pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span>local_tz<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div>
<p>Let's try to use it:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># Localize TZ-unaware datetimes to the selected timezone</span>
<span class="token operator">>></span><span class="token operator">></span> tzunaware_in_tokyo <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tzaware_in_tokyo <span class="token operator">=</span> tzaware_localize<span class="token punctuation">(</span>tzunaware_in_tokyo<span class="token punctuation">,</span> <span class="token string">'Asia/Tokyo'</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tzaware_in_tokyo
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">680085</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span><span class="token operator">&lt;</span>DstTzInfo <span class="token string">'Asia/Tokyo'</span> JST<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span> STD<span class="token operator">></span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token comment">### Convert a datetime to another timezone</span>
<span class="token operator">>></span><span class="token operator">></span> now_in_paris <span class="token operator">=</span> tzaware_localize<span class="token punctuation">(</span>tzaware_in_tokyo<span class="token punctuation">,</span> <span class="token string">'Europe/Paris'</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> now_in_paris
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">680085</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span><span class="token operator">&lt;</span>DstTzInfo <span class="token string">'Europe/Paris'</span> CEST<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span> DST<span class="token operator">></span><span class="token punctuation">)</span>
</code></pre></div>
<p>Basically, if you add timezone information to a timezone unaware datetime,
please use the <code>localize</code> method of the datetime object.
Please use <code>astimezone</code> if you want to convert a tz-aware datetime to a
different timezone.</p>
<h2 id="python-ecosystem"><a href="#python-ecosystem" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Python ecosystem</h2>
<p>As a side note to the Python world, numpy does not currently support
timezone-aware datetimes at the time of writing, while pandas does!</p>
<p>Though, I would advise you to store and process all times as UTC. They should
only be converted when you need to show them to the user.</p>
<p>Here is how you can convert a series to UTC tz-aware datetime in pandas:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-py"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

utc_timestamp <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> utc<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div>
<p>For communication with a database system, there are plugins for SQLAlchemy
that handles tz-aware datetimes. Please consider <a href="https://github.com/spoqa/sqlalchemy-utc/" rel="nofollow noopener noreferrer" target="_blank">sqlalchemy-utc</a> for example.</p>
<h1 id="databases-example-with-postgresql"><a href="#databases-example-with-postgresql" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Databases: Example with PostgreSQL</h1>
<p>You should store all times as UTC in databases.
PosgreSQL has two types to store datetimes:</p>
<ul>
<li>TIMESTAMP WITHOUT TIME ZONE</li>
<li>TIMESTAMP WITH TIME ZONE</li>
</ul>
<p>But don't be fooled. None of them actually <em>store</em> time zone information.</p>
<p>A <code>TIMESTAMP WITHOUT TIME ZONE</code> is just what its namesake is, a timestamp without time zone, while a
<code>TIMESTAMP WITH TIME ZONE</code> is implicitly converted to the connection's timezone
everytime the value is read. That's the only difference.
In term of data representation, they store the same thing.</p>
<p>If the connection timezone is not set, a <code>TIMESTAMP WITH TIME ZONE</code> will be converted to whatever
default your PostgreSQL instance is configured with (usually UTC).</p>
<p>You can check your connection's timezone with:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-sql"><code><span class="token keyword">SHOW</span> TIMEZONE<span class="token punctuation">;</span>
</code></pre></div>
<p>By default, the query should return 'UTC'.</p>
<p>You can set your connection's timezone with:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-sql"><code><span class="token keyword">SET</span> <span class="token keyword">TIME</span> ZONE <span class="token string">'Asia/Tokyo'</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Then <code>SHOW TIMEZONE</code> will return 'Asia/Tokyo', and all <code>TIMESTAMP WITH TIME ZONE</code>
will be converted from UTC to the timezone (+9 hour offset for Japan for a
post-war datetime).</p>
<p>You should especially be cautious when dealing with dates! What date a timestamp
falls on is dependent on the timezone!
The date now is 2018-07-04 in Tokyo, but 2018-07-03 in New York. That's the previous day!</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> my_table
<span class="token comment">-- Here, the UTC datetime will be converted to the date in the connection's timezone!</span>
<span class="token keyword">WHERE</span> my_table<span class="token punctuation">.</span>datetime_column::<span class="token keyword">date</span> <span class="token operator">=</span> <span class="token string">'2018-07-04'</span>::<span class="token keyword">date</span>
</code></pre></div>
<p>If your business analytics software happens to connect to a PostgreSQL database,
do not forget to set the connection timezone appropriatly! If not, you may get
surprises when you query the database!</p>
<p><strong>NB:</strong></p>
<ul>
<li>You can store timezones as a separate column in a database.
<a href="http://sqlalchemy-utils.readthedocs.io/en/latest/data_types.html#module-sqlalchemy_utils.types.timezone" rel="nofollow noopener noreferrer" target="_blank">SQLAlchemy-Utils even has a dedicated type</a> for it!
So if need be, you may store the timezone
of a timestamp in another column.</li>
<li>If you ever need to explicitly convert to a specific timezones, you can use the
"AT TIME ZONE" operator in PostgreSQL.</li>
<li>If you are wondering how pytz knows which offset is used at what time in
what area, they are using the official <a href="https://github.com/eggert/tz" rel="nofollow noopener noreferrer" target="_blank">Time Zone Database</a>.</li>
</ul></div> <div class="w-full px-2 xs:mb-6 md:mb-12 article-card"><a href="/en/blog/author/olivier" class="flex transition-shadow duration-150 ease-in-out shadow-sm hover:shadow-md xxlmax:flex-col"><img src="/img/authors/pic-malik-olivier-boussejra.png" class="h-48 xxlmin:w-1/2 xxlmax:w-full object-cover"> <div class="flex flex-col m-4"><h4 class="font-semibold">Author</h4> <p>Malik Olivier Boussejra</p> <p>CTO at Epigno</p></div></a></div> <div class="flex justify-between mt-8"><span> </span> <span> </span></div> <footer class="flex justify-center border-gray-500 border-t-2"><p class="mt-4"><a href="https://epigno.jp" class="font-bold hover:underline"> Epigno </a></p></footer></div></article></div></div></div><script>window.__NUXT__={staticAssetsBase:"/_nuxt/static/1606809417",layout:"default",error:null,serverRendered:!0,routePath:"/en/blog/timezones-are-hell",config:{content:{dbHash:"4d64471e"}}}</script><script src="/_nuxt/c49df97.js" defer></script><script src="/_nuxt/e275d6c.js" defer></script><script src="/_nuxt/ebf3282.js" defer></script><script src="/_nuxt/f660dd4.js" defer></script><script src="/_nuxt/1d9a650.js" defer></script>
  </body>
</html>
